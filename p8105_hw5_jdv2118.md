p8105_hw5_jdv2118
================
Justin Vargas
2022-11-15

\#Loading Libraries

``` r
library(tidyverse)
```

    ## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
    ## ✔ ggplot2 3.3.6      ✔ purrr   0.3.4 
    ## ✔ tibble  3.1.8      ✔ dplyr   1.0.10
    ## ✔ tidyr   1.2.1      ✔ stringr 1.4.1 
    ## ✔ readr   2.1.2      ✔ forcats 0.5.2 
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()

``` r
library(dplyr)
library(broom)
```

    ## Warning: package 'broom' was built under R version 4.2.2

# Problem 3

The following code is used to create a simulation function with the
following design elements of n = 30 and sigma = 5.

``` r
simulation_function = function(n = 30, mu, sigma = 5) {
  
  x = rnorm(n, mean = mu, sd = sigma)
  t_test = t.test(x = x, alternative = "two.sided", conf.level =   0.95) %>%
  tidy() %>%
  select(estimate, p.value)
} 
```

The following code is a simulation of when mu = 0, 5000 datasets are
generated by the model, and the estimate and p-value are obtained from a
one-sample t-test.

``` r
mu_0_simulation = rerun(5000, simulation_function(mu = 0)) %>%
bind_rows()
```

The following code is a simulation for when mu is equal to 0 through 6,
5000 datasets are generated for each mu, and the estimate and p-value
are obtained from a one-sample t-test.

``` r
mu_sim = tibble(mu = c(0,1,2,3,4,5,6)) %>%
  mutate(output = map(.x = mu, ~rerun(5000,
  simulation_function(mu = .x))),
  result = map(output, bind_rows)) %>%
  select(-output) %>%
  unnest()
```

    ## Warning: `cols` is now required when using unnest().
    ## Please use `cols = c(result)`

## Plot 1

The following code is used to produce a plot that shows the proportion
of times the null hypothesis was rejected and the true value of mu.
Based on the plot, one can observe that as the true mean increases, the
power also increases. Additionally, as the true mean increases, the
effect size also increases. Please note that the proportion of times the
null hypothesis was rejected becomes relatively stable at around 1 for a
true mean of 4, 5, and 6.

``` r
null_reject_plot = 
  mu_sim %>%
  group_by(mu) %>%
  summarize(number = n(),
  p_value = sum(p.value < 0.05),
  proportion_null_reject = p_value/number) %>%
  ggplot(aes(x = mu, y = proportion_null_reject)) + 
  geom_point() +
  labs(
    x = "True Mean", 
    y = "Proportion of Times the Null Hypothesis Was Rejected",
    title = "Proportion of Times the Null Hypothesis Was Rejected Vs. True Mean"
  )

null_reject_plot
```

![](p8105_hw5_jdv2118_files/figure-gfm/unnamed-chunk-5-1.png)<!-- -->

## Plot 2

``` r
average_true_mean_plot = 
  mu_sim %>%
  group_by(mu) %>%
  summarize(estimate_average = mean(estimate)) %>%
  ggplot(aes(x = mu, y = estimate_average)) + 
  geom_point() +
  labs(
    x = "True Mean", 
    y = "Average Estimated Mean", 
    title = "Average Estimated Mean Vs. True Mean For All Samples"
  )

average_true_mean_plot 
```

![](p8105_hw5_jdv2118_files/figure-gfm/unnamed-chunk-6-1.png)<!-- -->

## Plot 3

The sample average of mu across tests for which the null is rejected is
approximately equal to the true value of mu. However, it is important to
note that when the true mean is equal to 1, the average estimated mean
is about 2.25. It is also important to note that when the true mean is
equal to 2, the average estimated mean is about 2.5. All of the other
average estimated means are relatively more equal to the corresponding
true mean, such as 0, 3, 4, 5, and 6.

``` r
average_null_reject_plot =
  mu_sim %>%
  filter(p.value < 0.05) %>%
  group_by(mu) %>%
  summarize(estimate_average = mean(estimate)) %>%
  ggplot(aes(x = mu, y = estimate_average)) + 
  geom_point() +
  labs(
    x = "True Mean", 
    y = "Average Estimated Mean",
    title = "Average Estimated Mean vs. True Mean For Rejected Null Hypothesis Samples"
  )
  
average_null_reject_plot
```

![](p8105_hw5_jdv2118_files/figure-gfm/unnamed-chunk-7-1.png)<!-- -->
